document.getElementById('year').textContent=(new Date).getFullYear();
async function loadInventory(){try{const r=await fetch('./data/inventory.json');return (await r.json())||[]}catch(e){return []}}
function $(s){return document.querySelector(s)}
function formatPrice(n){try{return new Intl.NumberFormat(undefined,{style:'currency',currency:'USD'}).format(n)}catch{return `$${n}`;}}
function render(list){const grid=$('#inventory');grid.innerHTML='';const tpl=document.getElementById('card-tpl');list.forEach(c=>{const n=tpl.content.cloneNode(true);const t=n.querySelector('.thumb'),ti=n.querySelector('.title'),p=n.querySelector('.price'),y=n.querySelector('.year'),st=n.querySelector('.status'),m=n.querySelector('.mileage'),d=n.querySelector('.desc'),tags=n.querySelector('.tags');if(c.images&&c.images[0])t.style.backgroundImage=`url('${c.images[0]}')`;ti.textContent=c.title||`${c.year||''} ${c.make||''} ${c.model||''}`.trim();if(c.price!=null)p.textContent=formatPrice(c.price);y.textContent=c.year||'';st.textContent=c.status||'';m.textContent=(c.mileage??0).toLocaleString()+' mi';d.textContent=c.description||'';(c.tags||[]).slice(0,4).forEach(x=>{const s=document.createElement('span');s.textContent=x;tags.appendChild(s)});grid.appendChild(n)});if(!list.length){grid.innerHTML='<div style="grid-column:1/-1;padding:32px;border:1px dashed #cbd5e1;border-radius:16px;text-align:center;color:#475569">No vehicles yet. Click Admin to add one.</div>'}}
(async()=>{const items=await loadInventory();render(items);})();